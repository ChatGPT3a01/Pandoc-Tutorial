🌟 Pandoc 安裝與使用完整指南（Windows）
🔧 一、Pandoc 的用途（為什麼一定要裝它）

Pandoc 是「文件界的瑞士刀」，能把幾乎所有文件格式互轉：

Markdown → PDF / Word / HTML

Word → Markdown

PDF（文字型）→ Markdown

LaTeX → PDF

JSON → Markdown

甚至支援自訂模板，非常適合做你的 AI 教案生成器、自動簡報系統等功能。

🧩 二、如何在 Windows 安裝 Pandoc
1️⃣ Step 1. 前往官網下載

➡️ https://pandoc.org/installing.html

請下載 Windows x86_64 (.msi) 安裝檔。

2️⃣ Step 2. 執行安裝

安裝時一路按 Next → Accept → Install 即可。
（Windows 會自動設定環境變數 PATH，不需手動設定）

3️⃣ Step 3. 確認是否成功

開啟 CMD 或 PowerShell 輸入：

pandoc -v


如果有輸出版本資訊，例如：

pandoc 3.1.1


表示安裝成功！

📦 三、Pandoc 最常用的轉換指令

以下全部都能直接複製使用。

✨ 1. Markdown → PDF

⚠️ 若要輸出 PDF，請先安裝 LaTeX（最推薦 TinyTeX，不會太大）
教學在後面會附上。

pandoc input.md -o output.pdf


如果要使用繁體中文字型（避免亂碼）：

pandoc input.md -o output.pdf --pdf-engine=xelatex -V CJKmainfont="Noto Serif CJK TC"

✨ 2. Markdown → Word (.docx)
pandoc input.md -o output.docx

✨ 3. Word (.docx) → Markdown
pandoc input.docx -o output.md


非常適合你把老師們的 Word 教案快速轉成 Markdown！

✨ 4. Markdown → HTML（可用於 GitHub Pages、簡報）
pandoc input.md -o index.html

✨ 5. 多檔案合併（最常用在整本講義編排）
pandoc part1.md part2.md part3.md -o book.pdf --pdf-engine=xelatex

🖨 四、PDF 中文字型設定（避免亂碼）

因為你已經偏好使用 Noto Serif CJK 字型，我給你最乾淨版本：

Step 1. 安裝字型

下載 Noto Serif CJK TC：
https://fonts.google.com/noto/specimen/Noto+Serif+TC

安裝後即可在 Pandoc 中使用。

Step 2. 編譯 PDF 時加入：
pandoc input.md -o output.pdf --pdf-engine=xelatex -V CJKmainfont="Noto Serif CJK TC"

🧰 五、PDF 引擎安裝（LaTeX）

Pandoc 必須搭配 LaTeX 才能輸出 PDF。

✔️ 最推薦：TinyTeX（輕量、快、適合 Windows）

在 RTools 或 PowerShell 裡輸入：

winget install miktex


或你也可離線下載 MiKTeX：

https://miktex.org/download

MiKTeX 安裝後，Pandoc 就能用 xelatex 編譯。

🧪 六、給你一個最常用的實戰指令模板

以下是老師最常用、最穩定、支援中文的 PDF 轉換：

pandoc input.md -o output.pdf ^
  --pdf-engine=xelatex ^
  -V CJKmainfont="Noto Serif CJK TC" ^
  -V geometry:margin=2cm ^
  -V fontsize=12pt

🧭 七、如果要整合到自動化流程（如 GAS、Python、自動筆記生成）
🔹 Python 呼叫 Pandoc
import subprocess

subprocess.run([
    "pandoc",
    "input.md",
    "-o", "output.pdf",
    "--pdf-engine=xelatex",
    "-V", "CJKmainfont=Noto Serif CJK TC"
])


你之後做自動 Markdown → PDF 的工作流程都能用這段。

Pandoc 在 Windows 環境的完整使用教學

Pandoc 是一款功能強大的「文件萬用轉換器」，可在不同格式之間轉換文件（如 Markdown↔️PDF、HTML、Word 等）
sam.webspace.tw
。本指南針對 Windows 平台，說明從安裝到進階應用的每個步驟，內容涵蓋：Pandoc 本體與 LaTeX 編譯器的安裝、Markdown 轉換為 PDF/Word/HTML 的指令範例、繁體中文字型設定、LaTeX 數學公式、圖片與圖表插入範例、Mermaid.js 圖表整合，以及將上述功能整合至一鍵執行的批次檔或 PowerShell 腳本（進階）。請按照以下步驟進行：

安裝 Pandoc（Windows）

下載安裝檔：前往 Pandoc 官方 GitHub 下載頁面，取得最新版本的 Windows 安裝程式（.msi 檔）
pandoc.org
pandoc.org
。您也可以使用軟體套件管理工具（例如 Chocolatey）安裝 Pandoc
pandoc.org
。

執行安裝程式：雙擊下載的 .msi 安裝檔，依照指示完成安裝。安裝程式會自動將 Pandoc 路徑加入系統環境變數，安裝完成後可在命令提示字元或 PowerShell 中直接使用 pandoc 指令
pandoc.org
。

驗證安裝：開啟 PowerShell 或 CMD，輸入 pandoc -v 並按 Enter，應該會顯示 Pandoc 版本訊息。如果顯示版本號則表示安裝成功。

提示：Pandoc 安裝也可以透過其他方式完成，例如直接下載 Zip 壓縮檔並手動將可執行檔放置於某資料夾後加入環境變數，或使用 choco install pandoc（Chocolatey）或 winget install pandoc 等工具
pandoc.org
pandoc.org
。本教學以官方安裝程式為主。

安裝 LaTeX 編譯器（支援 PDF 輸出與繁體中文）

Pandoc 本身不包含 PDF 排版引擎，而是預設依賴外部的 LaTeX 發行版來產生 PDF
pandoc.org
。為了讓 Pandoc 能順利將 Markdown 輸出為 PDF，您必須安裝 LaTeX 編譯器。在 Windows 上，建議使用 MiKTeX（輕量且會自動下載所需套件）：

下載 MiKTeX：前往 MiKTeX 官方網站 下載適用於 Windows 的安裝程式並執行安裝
sam.webspace.tw
。安裝過程中可選擇「按需安裝套件」功能，讓未來缺少某些 LaTeX 套件時自動從網路安裝
sam.webspace.tw
（例如文件中有中文時會自動安裝 cjk 套件支援中文排版）。

驗證安裝：安裝完成後，在命令列執行 xelatex --version 看看是否有版本輸出，以確保 LaTeX 編譯器已加入 PATH。若無，請重新啟動電腦或手動將 MiKTeX 的路徑（例如 C:\Program Files\MiKTeX\miktex\bin\x64）加入環境變數 PATH。

說明：Pandoc 預設使用 pdflatex 引擎製作 PDF，但 pdflatex 對 UTF-8 編碼中文的支援不佳
pandoc.org
。我們將在後續指令中改用 xelatex 引擎以完整支援 Unicode 字型和繁體中文。

Markdown 轉換為 PDF、Word、HTML 的指令範例

Pandoc 使用命令列介面，基本用法格式為：

pandoc <輸入檔案> -o <輸出檔案> [選項...]


其中 <輸入檔案> 通常是 Markdown 檔 (.md)，<輸出檔案> 則由副檔名決定格式（如 .pdf、.docx、.html 等)。以下分別說明轉換為 PDF、Word 文件 (.docx)、HTML 的完整指令與範例：

將 Markdown 轉換為 PDF

基本轉換：執行下列指令，將 input.md 轉換為 output.pdf：

pandoc input.md -o output.pdf


此指令會將 Markdown 轉為 PDF
ditig.com
。但若文件含有中文，直接執行可能會遇到字型缺失或產生空白 PDF 的問題
pandoc.org
。因此，建議加入 PDF 引擎與字型設定，如下。

指定 PDF 引擎為 XeLaTeX：加入選項 --pdf-engine=xelatex，使用 XeLaTeX 引擎來生成 PDF。
sam.webspace.tw
。XeLaTeX 完全支援 Unicode，可正確處理中文
pandoc.org
。

設定繁體中文字型：使用 -V CJKmainfont="<字型名稱>" 選項指定 PDF 中文字型。如沒有設定中文字型，Pandoc 轉 PDF 可能會失敗或中文字無法顯示
sam.webspace.tw
。範例：

pandoc input.md -o output.pdf --pdf-engine=xelatex -V CJKmainfont="Noto Serif CJK TC"


上述命令將以 XeLaTeX 編譯，並使用「Noto Serif CJK TC」字型作為主要中文字型輸出 PDF。如系統已安裝「微軟正黑體」（Microsoft JhengHei），可改用：

pandoc input.md -o output.pdf --pdf-engine=xelatex -V CJKmainfont="Microsoft JhengHei"


-V 用來設定模板變數，CJKmainfont 專門對應 XeLaTeX 的中文主要字型
sam.webspace.tw
。請確保所指定的字型已安裝且支援繁體中文所有字元，否則仍可能出現缺字或錯誤
sam.webspace.tw
。例如，若文件包含 emoji，而所選字型未涵蓋該符號，也會導致轉換錯誤。

註：您也可以在 Markdown 文件開頭的 YAML 區塊中指定字型，例如加入：

---
CJKmainfont: "Noto Serif CJK TC"
---


這樣無需在命令列每次都加參數。Pandoc 會讀取此元資料設定套用字型。

完整範例：假設您有繁體中文 Markdown 檔案 教材.md，要轉為 PDF，可用以下指令：

pandoc 教材.md -o 教材.pdf --pdf-engine=xelatex -V CJKmainfont="Noto Serif CJK TC"


執行後，Pandoc 透過 XeLaTeX 排版產生 PDF。若一切順利，教材.pdf 將包含正確顯示的繁體中文文字。
pandoc.org

參考：
pandoc.org
Pandoc 官方 FAQ 也指出，遇到中文轉 PDF 空白的情況時，可透過改用 XeLaTeX 並指定含中文字型來解決。

將 Markdown 轉換為 Word（.docx）

基本轉換：執行下列指令將 Markdown 檔轉為 Word 檔：

pandoc input.md -o output.docx


Pandoc 會直接產生 .docx 格式檔案
ditig.com
。例如：

pandoc 範例.md -o 範例.docx


這會將 範例.md 轉換為 範例.docx。
freecodecamp.org

中文字型：Pandoc 轉換至 Word 時，會保留文字內容和基本格式，但字型部份通常由 Word 本身套用預設樣式。若要指定特定字型，可以在 Word 打開文件後手動套用樣式，或利用 Pandoc 的 reference docx 模板功能。例如您可建立一個包含理想字型設定的 Word 模板，然後使用參數 --reference-doc=<模板檔> 讓 Pandoc 套用該樣式
cheatsheetshero.com
（此屬進階用法，可視需要採用）。

公式與物件：Pandoc 會自動將 Markdown 中的數學公式轉換為 Word 中的原生方程式物件（Office Math ML），不須額外參數設定
groups.google.com
。圖片也會內嵌於輸出 docx 中。因此，大部分情況下，直接使用 Pandoc 轉換後的 Word 檔已可直接編輯或列印。

範例：將 教材.md 轉為 Word 檔：

pandoc 教材.md -o 教材.docx


完成後，用 Word 開啟 教材.docx，即可看到轉換後的文件內容（含標題、段落、清單、圖片等），並可在 Word 進一步編修格式。

將 Markdown 轉換為 HTML

基本轉換：執行下列指令將 Markdown 檔轉為獨立完整的 HTML 檔：

pandoc input.md -o output.html -s


參數 -s 或 --standalone 用於產生一個完整的 HTML 文件（包含 <html><head>...</head><body>...</body></html> 結構），否則 Pandoc 只會輸出 HTML 片段
pandoc.org
。例如：

pandoc 範例.md -o 範例.html -s


指定樣式 (CSS)：您可以使用 --css 引數為輸出的 HTML 指定 CSS 檔案，以套用自訂樣式
ditig.com
。例如，有一份樣式檔 style.css，可執行：

pandoc 範例.md -o 範例.html -s --css=style.css


如此輸出的 HTML 檔會在 <head> 中引用 style.css，讓內容呈現符合自訂樣式。

數學公式：為了在瀏覽器中正確呈現 LaTeX 數學公式，需要載入數學渲染腳本。最簡單的方法是使用 Pandoc 的 --mathjax 選項，自動在輸出 HTML 中插入 MathJax 的 CDN 腳本引用
pandoc.org
。例如：

pandoc 範例.md -o 範例.html -s --mathjax


這會在 HTML 中加上一段引用 <script src="https://cdn.jsdelivr.net/npm/mathjax..."></script> 
pandoc.org
，瀏覽器開啟檔案時即可由 MathJax 將公式渲染為可見的數學符號。

繁體字型：HTML 預設使用瀏覽器字型設定顯示文字。如果希望指定繁體中文字型，可以在 CSS 中使用 font-family 設定。例如在 CSS 中加入：

body { font-family: "Microsoft JhengHei", "Noto Serif CJK TC", sans-serif; }


使頁面主要字型為正黑體或 Noto Serif 中易宋等。這步非必須，但可確保不同環境下有一致的字型呈現。

範例：將 教材.md 轉為 HTML，並使用 MathJax 處理公式：

pandoc 教材.md -o 教材.html -s --mathjax


生成的 教材.html 可用瀏覽器打開，應能看到完整排版的網頁，包括公式（由 MathJax 即時渲染），以及圖片、表格等內容。可進一步搭配自訂 CSS 美化網頁。

繁體中文字型設定指南

如前文所述，為了正確顯示繁體中文，關鍵是使用支援繁體字形的字型。Pandoc + XeLaTeX 排版 PDF 時，預設字型（如 Computer Modern）不含中日韩字元，會導致中文變成方框或輸出失敗
sam.webspace.tw
。下面彙總字型設定的重點：

使用 XeLaTeX：務必指定 --pdf-engine=xelatex。XeLaTeX 配合 fontspec 和 xeCJK 套件允許直接使用系統字型。
pandoc.org
sam.webspace.tw

指定 CJKmainfont：如採用 YAML metadata，可加入 CJKmainfont 欄位指定中文主要字型。
sam.webspace.tw
例如：

CJKmainfont: "Noto Serif CJK TC"


若無使用 YAML，可在命令列以 -V CJKmainfont="字型名" 傳入
sam.webspace.tw
。這告訴 XeLaTeX 使用該字型來渲染 CJK 字元。mainfont 參數則通常用於拉丁字母字型，不支援中文。

可用字型：常見的繁體字型有：

Noto Serif CJK TC / Noto Sans CJK TC（思源宋體/黑體，Google 提供的 Noto 字型，需另行下載安裝）。

微軟正黑體 (Microsoft JhengHei) – Windows 內建的無襯線中文字型，適合標題或投影片。

新細明體 / 細明體 (PMingLiu / MingLiu) – Windows 內建襯線字型，適合印刷風文檔（但字形較古典）。

Adobe 明體 Std – 常見的繁體中文字型（若安裝了 Adobe 套件可能附帶）。Pandoc 官方範例使用此字型說明中文支援
pandoc.org
。

字型切換：您可以同時指定西文與中文字型，例如 YAML 裡同時設置 mainfont: "Times New Roman" 與 CJKmainfont: "Microsoft JhengHei"。XeLaTeX 會將英文字母部分用 Times New Roman，中文部分用微軟正黑體，以確保各自語系文字使用適合的字型。

確保字元覆蓋：正如前述，所選字型必須包含文件中使用的所有字元
sam.webspace.tw
。若包含特殊符號、數學符號、emoji 等，可能需要在 LaTeX 模板中額外指定 fallback 字型，否則會出現缺字方塊。在一般教案或文件情境下，選擇一款包含繁體中文的 Unicode 字型通常即可避免大部分問題。

總之，在 Pandoc + LaTeX 工作流程中，指定適當的繁體中文字型是排除中文亂碼/缺字的必要條件
sam.webspace.tw
。一旦正確設定字型，Pandoc 轉換的 PDF、Word 等文件就能順利顯示繁體中文內容。

LaTeX 數學公式的插入與支援

Pandoc Markdown 支援直接使用 LaTeX 數學語法插入數學公式，包含行內公式與展示型（區塊）公式兩種：

行內公式：使用單一美元符號區隔，例如撰寫 $E=mc^2$ 會產生愛因斯坦質能方程顯示在行文字中
pandoc.org
。

展示型公式：使用雙美元符號獨立一段隔開，例如：

$$\sum_{i=1}^n i = \frac{n(n+1)}{2}$$


以上在轉換後會以置中的展示數學公式呈現該等差級數求和公式
pandoc.org
。請注意開頭的 $$ 和結尾的 $$ 必須各自獨占一行，且中間不能有空行
pandoc.org
。

Pandoc 會保留並識別這些數學語法，在所有輸出格式中盡可能還原為對應的公式
pandoc.org
：

PDF（LaTeX 輸出）：公式將直接以 LaTeX 數學環境呈現（行內公式包在 \(...\) 中，展示公式包在 \[...\] 中）
pandoc.org
。XeLaTeX 引擎會將其排版為精美的數學符號，與 LaTeX 文檔中的效果相同。

Word (.docx)：Pandoc 自動將公式轉換為 Word 的原生方程式 (OMML 格式)
groups.google.com
pandoc.org
。換言之，您在 Markdown 裡寫的 $E=mc^2$，轉成的 .docx 檔中會成為可以用 Word 編輯的方程式物件，而不是純圖片或純文字。這讓公式在 Word 中保持可編輯、可調整格式的狀態。

HTML：如前節所述，預設情況下 Pandoc 會嘗試以 Unicode 字符呈現簡單的數學符號，但對複雜公式效果不佳
pandoc.org
。建議使用 --mathjax 或 --katex 等選項來輔助渲染
pandoc.org
。--mathjax 會在 HTML 中用 <span class="math">...</span> 包裹 LaTeX 公式，並載入 MathJax 腳本，在瀏覽時將它們渲染為排版良好的數學符號
pandoc.org
。另一選擇是 --katex 參數，作用類似但使用 KaTeX 庫來渲染。

公式編寫注意事項：行內公式的起始 $ 符號右側不可緊跟空白，結束 $ 左側不可緊跟空白或數字
pandoc.org
。例如書寫 $20 and $30 Pandoc 不會將其視為數學公式（避免與貨幣符號混淆）
pandoc.org
。如果想在文件中顯示實體 $ 符號（非公式用途），可用反斜線跳脫，如 \$100。

範例：在 Markdown 中可以這樣書寫內容：

我們有愛因斯坦公式 $E = mc^2$，可以計算質能轉換關係。

推導過程如下：

$$
E = mc^2 \\
\text{其中}\\
m = \text{物體質量(公斤)} \\
c = \text{光速(約 }3\times10^8 \text{ m/s)}
$$


轉換為 PDF 時，上述文字第一句會出現行內公式 E = mc^2；接著展示公式部分會以置中排列、換行顯示多行推導。
pandoc.org
在 Word 中，同樣會得到對應的可編輯公式；在 HTML 中，則需透過 MathJax 進行動態渲染以達到類似的顯示效果。

總而言之，Pandoc 良好地支援 LaTeX 公式，使您能在 Markdown 中直觀地插入數學符號而無須額外工具。只需注意在轉換 HTML 時加上 --mathjax 等參數，以確保網頁中公式正常顯示即可
pandoc.org
。

插入圖片與圖表的範例

在教學文件中經常需要插入圖片、照片或圖表。Pandoc 支援 Markdown 語法的圖片標記，並會在輸出時妥善處理圖像的嵌入。以下說明如何在 Markdown 中插入圖片與圖表，以及 Pandoc 處理的結果。

Markdown 插入圖片的基本語法

使用驚嘆號 ! 開頭的連結語法來插入圖片。基本格式為：

![替代文字](圖片路徑 "選用的標題")


替代文字（Alt text）：圖片無法顯示時的替代說明文字，也用作 PDF/Word 中的圖片說明（caption）
pandoc.org
。

圖片路徑：可以是本地相對/絕對路徑，如 images/pic1.png，也可以是網路 URL。

標題：可選的文字，放在路徑後的引號中，部分格式會用作附加說明或 tooltip。

範例：在 Markdown 中插入一張名為 diagram.png 的流程圖，並加上說明：

![流程圖：系統運作示意](diagram.png "系統流程圖")


如果這段語法獨立成段落（段前有空行，段後也換行），Pandoc 會將它識別為「帶標題的圖形」並在輸出中產生圖號與說明
pandoc.org
。例如在 PDF/Word 中，它會變成一個置中的圖片，下面有「圖：系統運作示意」的標題文字。如果該圖片語法並非獨占一段（如前後有文字），則視為行內圖片，將直接嵌在文字中顯示，不會產生圖表標題
pandoc.org
。

調整圖片大小與樣式

Pandoc 擴充的 Markdown 語法允許在圖片後以大括號附加屬性來控制顯示樣式
pandoc.org
。常見用途是設定圖片寬度、高度、CSS 類別等。例如：

![教學介面截圖](screenshot.png){ #fig:ui .center width=50% }


上例中：

{#fig:ui} 為圖片設定了識別碼，可供交叉引用（搭配 pandoc-crossref 等插件）。

.center 是自訂的 CSS class，可能用於 HTML 居中圖片等。

width=50% 則指定寬度為50%
pandoc.org
。Pandoc 會依輸出格式換算此寬度：如對 HTML 輸出產生 style="width:50%;"，對 LaTeX/PDF 則轉為 width=0.5\textwidth
pandoc.org
。這表示圖片寬度為當前文字區域一半寬。

也可使用絕對單位，例如 {width=10cm} 或 {height=300px} 等。Pandoc 會依需要轉換單位到目標格式。若未指定寬高，Pandoc 預設會以圖片的實際解析度和文件 DPI 計算尺寸
pandoc.org
pandoc.org
。

注意：若希望在 PDF 中防止圖片過大超出頁邊距，Pandoc 的 LaTeX 模板預設已經包含一段代碼限制圖片最大寬高為頁面可用區域大小
pandoc.org
。因此將圖片插入 PDF 不需要擔心它溢出頁邊。

輸出格式對圖片的處理

PDF：Pandoc 會在產生的 LaTeX 中使用 \includegraphics 插入圖檔。您不需要手動加入 \usepackage{graphicx}，因為 Pandoc 預設模板已經載入。圖片檔案若為常見格式（PNG/JPEG/PDF 等）會被直接嵌入。如果圖片是 SVG 向量圖，XeLaTeX 本身不直接支援，Pandoc 會自動嘗試調用 rsvg-convert 將 SVG 轉換為 PDF 矢量圖或 PNG 點陣圖
pypi.org
再插入（因此建議安裝 [librsvg 工具][rsvg]以確保 SVG 嵌入正確）。

Word：Pandoc 會將圖片轉為 Office 文件中的嵌入影像。輸出的 .docx 其實是壓縮封裝，圖片檔將存放在其中的 media 資料夾並在文檔中引用。所以最終得到的 Word 文件已經自包含所有圖片，不需再另外攜帶圖片檔。

HTML：預設情況下，Pandoc輸出的 HTML 會包含圖片的 <img> 標籤，其 src 指向您在 Markdown 中提供的路徑。如果使用了相對路徑，本地打開 HTML 時需確保圖片檔案相對位置正確；若要產生完全自包含的單一 HTML 檔案，可使用 --self-contained 選項，Pandoc 會把圖片檔案以 base64 編碼嵌入 HTML 中的 src 屬性，避免外部依賴。

範例：在教材的 Markdown 加入一張圖片：

教學流程如下圖所示：

![教學流程圖](teaching_flow.png){ width=80% }

如上所示，各階段環環相扣...


PDF 輸出：圖片將置中顯示，寬度為頁面文字寬度的 80%，下方標註「教學流程圖」作為圖表標題（因為 alt text 非空且圖片獨立成段
pandoc.org
）。

Word 輸出：圖片佔用頁面寬度的 80%，處在段落中（Word 中圖表標題需另行手動設定或使用樣式）。

HTML 輸出：生成 <img src="teaching_flow.png" style="width: 80%;" alt="教學流程圖" />
pandoc.org
。若該 HTML 同資料夾下有圖片檔，瀏覽器會按指定比例顯示。

插入圖表（表格）的說明

Markdown 也支持建構表格（使用管道符號 | 和短橫線），Pandoc 會將其轉換為對應格式的表格元素。由於問題中提及「圖表」，這裡簡述 Markdown 表格用法：

| 測試項目 | 第一次結果 | 第二次結果 |
|--------|----------:|----------:|
| 甲組   | 8.5      | 8.8      |
| 乙組   | 9.0      | 9.1      |
| 丙組   | 7.4      | 7.8      |


上述 Markdown 表格會轉換為：

PDF/LaTeX：生成對應的 tabular 環境。欄位對齊（如右對齊冒號）Pandoc 會自動設置 \raggedleft 等控制。可以搭配 booktabs 進階美化（Pandoc 模板預設已載入 longtable, booktabs 等套件）。

Word：轉為真正的 Word 表格，可編輯單元格內容。

HTML：產生 <table><tr><td>...</td>... 結構的表格。

您也可以在 Markdown 中為表格加標題：在表格上方緊跟一行以 Table: 開頭的文字描述即可，Pandoc 會識別為表格標題。例：

Table: 各組別兩次測試的平均成績比較

| 組別 | 第一次 | 第二次 |
|------|-------:|-------:|
| 甲   | 8.5   | 8.8   |
| 乙   | 9.0   | 9.1   |
| 丙   | 7.4   | 7.8   |


這會在輸出 PDF/Word 中成為一個有標題的表格 “表：各組別兩次測試的平均成績比較”。

Mermaid.js 圖表整合說明

Mermaid.js 是一套利用簡單文字語法來繪製圖表和流程圖的工具。如果您希望在 Markdown 中直接寫 Mermaid 語法並讓 Pandoc 轉換輸出包含該圖表，本節提供可行方案。

Mermaid 圖表在 HTML 輸出的處理

方法一：使用 Mermaid 客戶端渲染 – 您可以在輸出 HTML 中載入 Mermaid 的 JavaScript，讓瀏覽器在載入頁面時將 Mermaid 語法轉為圖表：

在 Markdown 中，使用程式碼區塊標記 Mermaid 語法，語法指定類別為 mermaid。例如：

<pre><code>```mermaid graph LR A[開始] --> B(判斷?) B -- 是 --> C[處理] B -- 否 --> D[結束] ```</code></pre>

這段會被 Pandoc 識別為一個類別為 “mermaid” 的程式碼區塊。

Pandoc 轉換 Markdown 為 HTML 時，預設會將此區塊輸出為 <pre><code class="language-mermaid">...</code></pre> 或類似的 HTML 結構，仍然是純文字。

載入 Mermaid 腳本：在生成的 HTML <head> 中引入 Mermaid 的腳本。例如您可以自製一個 HTML 模板，在其中 <head> 部分加上：

<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>mermaid.initialize({ startOnLoad:true });</script>


然後在 Pandoc 轉換時使用 -s --template=模板.html 參數套用它。這樣輸出 HTML 一打開，就會由 Mermaid 腳本將 <pre><code class="language-mermaid"> 內容轉換為 SVG 圖形。

上述方法需要使用者懂得編輯 HTML 模板並載入腳本，優點是圖表在 HTML 中以向量圖呈現且可套用 Mermaid 主題，缺點是無法直接產出 PDF（因為 PDF 不會執行瀏覽器腳本）。

Mermaid 圖表在 PDF/Word 輸出的處理

要將 Mermaid 圖表包含進 PDF 或 Word 等靜態文件，需要在轉換時先將 Mermaid 語法轉換成圖像再嵌入。Pandoc 本身沒有內建 Mermaid 支援，但可透過「過濾器（filter）」機制達成此目的。

方法二：使用 pandoc-mermaid 濾器 – 這是一個社群開發的 Pandoc 濾器，可以在 Pandoc 轉換過程中自動把 Mermaid 程式碼轉成圖片。使用步驟：

安裝 Node.js 與 npm：Mermaid 濾器基於 Node.js。如果尚未安裝，請先從 Node.js 官方網站 下載並安裝（安裝時可勾選「Add to PATH」）。

安裝 mermaid-filter：開啟命令列，執行：

npm install -g mermaid-filter


這將透過 npm 全域安裝 mermaid-filter 濾器
bagelquant.com
。安裝成功後，可在 %AppData%\Roaming\npm\ 目錄下找到 mermaid-filter.cmd 可執行文件（Windows 環境）。

使用 Pandoc 濾器參數：執行 Pandoc 時，加上 -F mermaid-filter（大小寫敏感，F 要大寫）參數
bagelquant.com
。這告訴 Pandoc 在轉換時先調用 Mermaid 濾器處理文件中的 mermaid 程式碼區塊。範例：

pandoc 教材.md -o 教材.pdf --pdf-engine=xelatex -F mermaid-filter


濾器會尋找 Markdown 中屬性為 .mermaid 的程式碼區塊，調用 Mermaid CLI 將其繪製成圖片再嵌入文件
bagelquant.com
。預設生成的是 PNG 圖檔
github.com
（背景白色，寬度800px，可在區塊屬性中用 width/height 調整）。

Windows 注意事項：在 Windows 上，有時需寫成 -F mermaid-filter.cmd 才能正確執行
github.com
。若直接 -F mermaid-filter 出現錯誤，可嘗試加上 .cmd 副檔名或使用絕對路徑。

檔案輸出：使用濾器轉換後的 PDF 檔會包含轉好的圖表（例如流程圖等）作為圖片嵌入其中
stackoverflow.com
stackoverflow.com
；同理，轉換為 Word 時這些圖表也會以圖片形式出現在文件裡。

範例：將包含 Mermaid 語法的 Markdown 檔轉為 PDF：

pandoc 含圖表.md -o 含圖表.pdf --pdf-engine=xelatex -F mermaid-filter


假設 含圖表.md 裡有：

```mermaid
graph TD;
    A[Start] --> B{Question?};
    B -->|Yes| C[OK];
    B -->|No| D[End];

那麼經過濾器，`含圖表.pdf` 中會看到對應的流程圖圖形。對 HTML 輸出：
```bash
pandoc 含圖表.md -o 含圖表.html -s -F mermaid-filter


則濾器預設會將圖以 data URI 形式內嵌為 <img src="data:image/png;base64,...">
github.com
。您將在 HTML 中直接看到渲染好的圖，不需額外載入 Mermaid 腳本。

💡 小提示：mermaid-filter 濾器允許一些進階設定，例如在 Markdown 的程式碼區塊標記中加入 {format=svg} 可輸出 SVG 矢量圖而非 PNG
github.com
；加入 {theme=dark} 可套用深色主題等。詳細可參考其 GitHub 說明文件。

關於 PDF 中 Mermaid 圖的替代方案：除了 pandoc 濾器，另一種方法是先將 Markdown 轉為 HTML（內嵌 Mermaid 腳本），再用無頭瀏覽器或轉檔工具（如 Chrome Puppeteer、wkhtmltopdf 等）將 HTML 轉為 PDF
stackoverflow.com
。然而此流程較繁瑣且對環境要求高，一般不如直接使用濾器方便。

總結而言，要在 Pandoc 工作流中整合 Mermaid.js 圖表，對 HTML 輸出可直接載入 Mermaid 腳本在客戶端渲染，對 PDF/Word 輸出建議使用 Node.js 濾器預先轉換圖表為圖片嵌入
bagelquant.com
。在教案製作中，如需呈現流程圖或時序圖，這項技術能讓您在 Markdown 中就維持圖表的可讀原始碼，又能獲得最終文件中的圖形化呈現，極大提高撰寫與維護效率。

（進階）一鍵轉換的批次腳本範例

若經常需要將 Markdown 文件一口氣輸出為多種格式，可以建立批次檔或 PowerShell 腳本，自動執行所有轉換指令。以下提供一個 Windows 批次檔 (convert.bat) 範例，可將傳入的 Markdown 檔轉換為 PDF、DOCX 和 HTML（三種輸出）的檔案：

@echo off
REM 檢查參數是否提供
if "%~1"=="" (
    echo 用法：將 Markdown 檔拖放到本批次檔，或在命令列執行：convert.bat filename.md
    pause >nul
    goto :EOF
)
set "infile=%~1"
set "outfile=%~dpn1"  REM 輸出檔不含副檔名，用於組合各格式檔名

echo 正在轉換 "%infile%" 為 PDF、Word、HTML...

REM 轉換為 PDF（使用 xelatex 引擎與繁體字型）
pandoc "%infile%" -o "%outfile%.pdf" --pdf-engine=xelatex -V CJKmainfont="Noto Serif CJK TC"

REM 轉換為 Word (.docx)
pandoc "%infile%" -o "%outfile%.docx"

REM 轉換為 HTML（產生獨立 HTML 並支援數學公式）
pandoc "%infile%" -o "%outfile%.html" -s --mathjax

echo 完成！輸出檔案已產生在 "%~dp1" 資料夾下。


將上述內容存為 convert.bat。使用時，可以將 Markdown 檔拖曳到批次檔圖示上，或在命令提示字元執行 convert.bat <檔名>.md。腳本會依序產生：

PDF：使用 xelatex 及指定的 Noto Serif CJK TC 字型，確保中文正常
pandoc.org
。

DOCX：轉換為 Word 檔（套用預設樣式）。

HTML：產生獨立 HTML 檔，內嵌 MathJax 引用以支援公式顯示
pandoc.org
。

您可按需修改此腳本，例如更換字型名稱，或加入 -F mermaid-filter 參數以在有 Mermaid 語法時處理圖表。

PowerShell 範例：若偏好 PowerShell，以下是等效的簡易腳本（convert.ps1）：

param([Parameter(Mandatory)][string]$InputFile)

$baseName = [System.IO.Path]::GetFileNameWithoutExtension($InputFile)
$dir = [System.IO.Path]::GetDirectoryName($InputFile)
if ($dir -eq "") { $dir = "." }

Write-Host "轉換 $InputFile 為多種格式..."
pandoc $InputFile -o "$dir\$baseName.pdf" --pdf-engine=xelatex -V CJKmainfont="Noto Serif CJK TC"
pandoc $InputFile -o "$dir\$baseName.docx"
pandoc $InputFile -o "$dir\$baseName.html" -s --mathjax
Write-Host "完成！輸出已存至 $dir"


執行方式是在 PowerShell 中輸入 .\convert.ps1 -InputFile 教材.md。兩種腳本原理類似，請依自己習慣選用。

透過此類「一鍵轉換」腳本，教師可以更便利地將課程講義 Markdown 同時輸出給學生 PDF 閱讀、給助教 Word 編輯以及上傳網站的 HTML，極大提升教案製作效率。